{% extends 'base_site.html' %}
{% load static %}

{% block content %}
<div class="container-fluid pt-4 px-4">
    <div class="row g-4">
        <form action="/student/studentregistration/" method="post" onsubmit="f_send_message()">{% csrf_token %}
        <div class="col-sm-12 col-xl-12">
            <div class="bg-light rounded h-100 p-4">
                <h6 class="mb-4">Student Registration Form</h6>
                    <div class="row mb-3">
                        <label for="inputName" class="col-sm-3 col-form-label">Name</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" id="inputName" name="inputName" required=True>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label for="inputGender" class="col-sm-3 col-form-label">Gender</label>
                        <div class="col-sm-9">
                            <select class="form-select" name="inputGender" id="inputGender">
                                <option value="F">Female</option>
                                <option value="M">Male</option>
                            </select>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label for="inputEmail" class="col-sm-3 col-form-label">Email</label>
                        <div class="col-sm-9">
                            <input type="email" class="form-control" id="inputEmail" required=True name="inputEmail">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label for="inputPhone" class="col-sm-3 col-form-label">Booked Phone</label>
                        <div class="col-sm-9">
                            <input type="text" class="form-control" id="inputPhone" required=True placeholder="Start with '62'" name="inputPhone">
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label for="inputAddress" class="col-sm-3 col-form-label">Address</label>
                        <div class="col-sm-9">
                            <textarea class="form-control" id="inputAddress" name="inputAddress"></textarea>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <legend class="col-form-label col-sm-3 pt-0">Send Message</legend>
                        <div class="col-sm-9">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="gridCheck1">
                                <label class="form-check-label" for="gridCheck1">
                                    Send Whatsapp Message
                                </label>
                            </div>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary">Create</button>
            </div>
        </div>
        </form>

        <div class="col-sm-12 col-xl-12">
            <div class="bg-light rounded h-100 p-4">
                <h6 class="mb-4">List Master Student</h6>
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th scope="col">#</th>
                            <th scope="col">Name</th>
                            <th scope="col">Booked Phone</th>
                            <th scope="col">Email</th>
                            <th scope="col">Date Created</th>
                            <th scope="col">Gender</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for data in datamst %}
                        <tr>
                            <th scope="row">{{forloop.counter}}</th>
                            <td>{{data.name}}</td>
                            <td>{{data.phone}}</td>
                            <td>{{data.email}}</td>
                            <td>{{data.date_created}}</td>
                            <td>{% if data.gender == 'M' %}
                                    Laki Laki
                                {% else %}
                                    Perempuan
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    function f_send_message()
  {
    const cb = document.querySelector('#gridCheck1');
    var phone = $('#inputPhone').val();
    var name = $('#inputName').val().split(" ")[0];
    var text = "Halo! Salam Kenal, " + name + "!\nIzin memperkenalkan diri, aku Ahmad Afif dari Superprof.\nAda yang bisa dibantu? Terimakasih";

    if (cb.checked){
        text = encodeURI(text);
        window.open("https://wa.me/"+phone+"?text="+text);
    }
  }
</script>
{% endblock content %}